/**
* NOTICE OF LICENSE
*
* This file is part of the 'Wk Warehouses Management For Prestashop 1.7' module feature.
* Developped by Khoufi Wissem (2018).
* You are not allowed to use it on several site
* You are not allowed to sell or redistribute this module
* This header must not be removed
*
*  @author    KHOUFI Wissem - K.W
*  @copyright Khoufi Wissem
*  @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
*/
function initCartButtons(){$('button.add-to-cart, [data-button-action="add-to-cart"]').on("click",function(t){var a,o,i,r;return t.preventDefault(),t.stopPropagation(),$product_item=$(this).closest("article"),a=$product_item.data("id-product"),o=$product_item.data("id-product-attribute"),i=1,$product_item.find('input[name="qty"]:visible').length>0&&(i=$product_item.find('input[name="qty"]:visible').val()),r={ajax:!0,action:"assignWarehouseToProductInCart",id_product:a,id_product_attribute:o},$.ajax({url:process_cart_url,type:"POST",dataType:"json",data:r,success:function(t){if(void 0!==t.multiWarehousesInCart&&t.multiWarehousesInCart)fancyCloseBox(t.message,"danger");else if(void 0!==t.isMultiCarriersInCart&&t.isMultiCarriersInCart)fancyCloseBox(t.message,"danger");else if(void 0!==t.hasError&&t.hasError)fancyCloseBox(t.message,"danger");else{var r={action:"update",add:1,id_product:a,qty:i,token:prestashop.static_token};o>0&&(r.id_product_attribute=o),$.post(prestashop.urls.pages.cart,r,null,"json").then(function(t){prestashop.emit("updateCart",{reason:{idProduct:t.id_product,idProductAttribute:t.id_product_attribute,idCustomization:t.id_customization,linkAction:"add-to-cart",cart:t.cart},resp:t})}).fail(function(t){prestashop.emit("handleError",{eventType:"addProductToCart",resp:t})})}}}),!1})}function fancyCloseBox(t,a){$.fancybox('<div class="alert alert-'+a+'" style="width:350px">'+t+'</div><p style="text-align:right; padding-bottom: 0" class="submit"><input type="button" onclick="$.fancybox.close();" value="'+txt_ok+'" class="button btn btn-danger"></p>')}$(document).ready(function(){prestashop.on("updateProductList",function(t){initCartButtons()}),initCartButtons()});